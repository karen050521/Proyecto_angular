<div class="notification-container">
      <button 
        class="nav-action-btn notifications-btn" 
        (click)="togglePanel()"
        aria-label="Notificaciones" 
        title="Notificaciones">
        <i class="bi bi-bell"></i>
        @if (unreadCount() > 0) {
          <span class="notification-badge">{{ unreadCount() }}</span>
        }
      </button>

      @if (showPanel()) {
        <div class="notification-panel" (click)="$event.stopPropagation()">
          <div class="panel-header">
            <h3>Notificaciones</h3>
            @if (unreadCount() > 0) {
              <button 
                class="mark-all-btn" 
                (click)="markAllAsRead()"
                title="Marcar todas como leídas">
                <i class="bi bi-check-all"></i>
              </button>
            }
          </div>

          @if (notifications().length > 0) {
            <div class="panel-body">
              @for (notification of notifications(); track notification.id) {
                <div 
                  class="notification-item"
                  [class.unread]="!notification.read"
                  (click)="viewOrder(notification)">
                  <div class="notification-icon">
                    <i class="bi bi-person-check-fill"></i>
                  </div>
                  <div class="notification-content">
                    <div class="notification-title">
                      Pedido #{{ notification.orderId }} asignado
                    </div>
                    <div class="notification-driver">
                      <i class="bi bi-scooter"></i>
                      <strong>{{ notification.driverName }}</strong>
                    </div>
                    <div class="notification-details">
                      {{ notification.orderDetails }}
                    </div>
                    <div class="notification-time">
                      {{ formatTime(notification.timestamp) }}
                    </div>
                  </div>
                  <button 
                    class="remove-btn"
                    (click)="removeNotification($event, notification.id)"
                    title="Eliminar notificación">
                    <i class="bi bi-x"></i>
                  </button>
                </div>
              }
            </div>
          } @else {
            <div class="empty-state">
              <i class="bi bi-bell-slash"></i>
              <p>No hay notificaciones</p>
            </div>
          }

          @if (notifications().length > 0) {
            <div class="panel-footer">
              <button class="clear-all-btn" (click)="clearAll()">
                Limpiar todo
              </button>
            </div>
          }
        </div>
      }
    </div>